<!doctype html>
<html>
    <head>
        <title>Burnt Toast</title>
        <meta charset="utf-8" />
        <script type="text/javascript" src="https://cdn.rawgit.com/showdownjs/showdown/1.7.6/dist/showdown.min.js"></script>
        <script type="text/javascript">
         function getQueryParams(qs) {
             qs = qs.split('+').join(' ');
             var params = {},
                 tokens,
                 re = /[?&]?([^=]+)=([^&]*)/g;
             while (tokens = re.exec(qs)) {
                 params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);
             };
             return params;
         };

         function createHTML(htmlStr) {
             var frag = document.createDocumentFragment(),
                 temp = document.createElement('div');
             temp.innerHTML = htmlStr;
             while (temp.firstChild) {
                 frag.appendChild(temp.firstChild);
             };
             return frag;
         };

         function retrievePage(page) {
             var req = new XMLHttpRequest(),
                 method = 'GET',
                 url = '/' + page + '.md';
             req.open(method, url, true);
             req.overrideMimeType('text/markdown');
             req.onreadystatechange = function () {
                 if (req.readyState != 4) {
                     return;
                 };

                 var converter = new showdown.Converter(),
                     html = converter.makeHtml(req.responseText);

                 if (req.status != 200) {
                     html = "<p>I am error<p>"
                 };

                 document.body.insertBefore(createHTML(html), document.body.childNodes[0]);
             };
             req.send();
         };

         function ready() {
             var params = getQueryParams(document.location.search),
                 page   = params.page || "home",
                 text   = retrievePage(page);
         };
        </script>
    </head>
    <body>
        <script type="text/javascript">
            ready();
        </script>
    </body>
</html>
